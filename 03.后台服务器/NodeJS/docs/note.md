# NodeJS

## 前言
[ws快捷键中英对照](https://www.cnblogs.com/ry123/p/4769676.html)

### 命令行窗口、cmd窗口、终端、shell
**常用指令：**
dir, cd, md, rd ...

### 环境变量
**path：**

当我们在命令行窗口打开一个文件或者程序，系统会先到当前目录下寻找再到环境变量
path路径中寻找。

可以将一些经常需要访问的程序或者文件路径添加到path中，快速访问。

### 进程和线程
**进程：**
- 为程序的运行提供必备的环境

**线程：**
- 计算机中的最小计算单位，负责执行进程中的程序
- 单线程、多线程

## 简介

Node服务器是单线程的，但是后台拥有一个I/O线程池。可以采用分布式（多台服务器）。
传统的服务器都是多线程，每进来一个请求就创建一个线程。

- Node.js是一个能够在服务器端运行的JavaScript的开放源代码，跨平台的js运行环境
- 采用Google开发的V8引擎运行js代码，使用事件驱动，非阻塞，异步I/O模型等技术来提高性能，可优化应用程序的传输量和规模
- 大部分基本模块使用js编写

### 发展
*网站性能：即响应速度，包括请求(用户网速)、响应(服务器带宽)、I/O(数据库读写，瓶颈)*
*传统服务器：一个请求创建一个线程，I/O会阻塞多线程，多线程占用内存*

瑞安·达尔(Ryan Dahl),于2009年02月开始着手编写Node.js。为了解决Web服务器的高并发性能问题。

**历史：**
- 2009年：瑞安·达尔在GitHub上发布node的最初版本
- 2010年1月：Node的包管理器npm诞生
- 2010年底：Joyent公司赞助Node开发，瑞安·达尔加入旗下，全职负责Node
- 2011年7月：Node在微软的帮助下发布了Windows版本
- 2011年11月：Node超越Ruby on Rails, 称为GitHub上关注度最高的项目

### 用途
- web服务api,如REST
- 实时多人游戏
- 后端的web服务，如跨域、服务器端的请求
- 基于web的应用
- 多客户端的通信，如即时通讯

## 其他

### CommonJS规范
- 为了弥补当前js没有标准的缺陷
- 为js指定了一个美好的愿景，希望js能够在任何地方运行
- 对模块化的定义十分简单：
    - 模块引用
    - 模块定义
    - 模块标识

**ECMAScript标准的缺陷：**
- 没有模块系统
- 标准库少
- 没有标准接口
- 缺乏管理系统

### 模块化
- 在node中，一个js就是一个模块
- node中，require()函数来引入外部模块

**模块标识：** 用来找到指定的模块
- 核心模块：node引擎提供，核心模块标识就是模块的名字
- 文件模块：用户自己创建的，模块的路径（绝对、相对），相对路径必须是.或者..开头

### package包
- CommonJS的包规范允许我们将一组相关的模块组合到一起，形成一组完整的工具
- 由包结构和包描述文件两个部分组成
    - 包结构：用于组织包中的各种文件
    - 包描述文件：描述包的相关信息，以供外部读取分析

包实际上就是一个压缩文件，解压后还原为目录。符合规范的目录，应该包含如下文件：
- package.json: 描述文件
- bin: 可执行的二进制文件
- lib: js文件
- doc: 文档
- test: 单元测试

### NPM(Node Package Manager)
- CommonJS包规范是理论，npm是其中一种实践
- 对于Node而言，npm帮助其完成了第三方模块的发布、安装和依赖等。
借助npm，node与第三方模块之间形成了很好的一个生态系统。

**常用命令：** npm
```
npm -v
npm version
npm search 包名
npm install | npm i 包名 (--save: 添加到依赖中。现在默认也是这样; cnpm不是）
npm remove | npm r 包名
npm i -g 包名 // 全局安装，一般是一些工具
npm i 包名 -registry=地址  // 从镜像源安装
npm config set registry 地址   // 设置镜像源
npm install -g cnpm --registry=https://registry.npm.taobao.org // 淘宝镜像，cnpm代替npm走国内服务器
```

node使用模块名字来引入模块是，首页会在当前目录node_modules中寻找；
如果有直接使用，没有则去上一级node_modules中找；
...
一直知道磁盘的根目录，没有则报错。

## 使用

### Buffer(缓冲区)
Buffer的结构和数组很像，操作的方法也类似。数组不能存储二进制的文件。

- 从结构上看Buffer非常像一个数组，他的元素为16进制两位数
- 实际上一个元素就表示内存中的一个字节
- Buffer中的内存不是通过js分配的，而是在底层通过c++申请的
- 可以直接通过Buffer来创建内存中的空间

### fs(文件系统)
通过node中fs模块来操作系统中的文件。

1. 同步和异步调用
- fs模块中所有的操作都有同步和异步两种形式
- 同步文件系统会阻塞程序执行，除非操作完毕，否则不会向下执行代码
- 异步不会阻塞，而是操作完成时，通过回调函数将结果返回







